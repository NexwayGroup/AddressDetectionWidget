(function(){var a,b,c,d=function(a,b){return function(){return a.apply(b,arguments)}},e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=function(){function a(a,c,d){this.element=a,this.options=$.extend({},b,c),this.instanceName=d,this.defaults=b}var b;return b={debug:!1,messageScope:"warning"},a.prototype.log=function(a,b){var c,d,e,f;null==b&&(b="info"),this.options.debug===!0&&(d="",e=!0,"error"===this.options.messageScope&&"info"===b&&(e=!1),"error"===this.options.messageScope&&"warning"===b&&(e=!1),"warning"===this.options.messageScope&&"info"===b&&(e=!1),"debug"===b&&(e=!0),"info"===b&&(f="background: white; color: grey",c="background: white; color: green"),"error"===b&&(f="background: red; color: white",c="background: white; color: red",d="(Error!)"),"warning"===b&&(f="background: white; color: orange",c="background: white; color: orange",d="(Warning)"),e&&console.log("%c "+this.instanceName+": "+d+" %c "+a,f,c))},a.prototype.getPluginByInstanceName=function(a,b,c){return null==c&&(c=-1),c>-1?$.data(a,b):$.data(a,b)},a.prototype.runForEachInstance=function(a,b){var c,d;c=0,d=this.pluginName,$(a).each(function(){return c+=1,null!=$.data(this,d+"_"+c)?b($.data(this,d+"_"+c)):null!=$.data(this,d+"_#"+$(this).attr("id"))?b($.data(this,d+"_#"+$(this).attr("id"))):void 0})},a}(),b=function(){function a(a){this.base=a}return a.prototype._closeCurrentPage=function(){this.base._currentElement.children().remove()},a.prototype.start=function(){var a;a='<div class="step-start alert alert-info" >\n  <button type="button" class="close"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>\n  <h4>'+this.base.options.texts.start.title+"</h4>\n  <p>"+this.base.options.texts.start.content+'</p>\n  <button type="button" class="detectBtn btn btn-primary btn-xs">'+this.base.options.texts.start.detectBtn+'</button>\n  <button type="button" class="cancelBtn btn btn-link">'+this.base.options.texts.cancelBtn+"</button>\n</div>",this._closeCurrentPage(),this.base._currentElement.html(a),this.base._currentElement.find(".detectBtn").on("click",function(a){return function(){a.base.detect()}}(this)),this.base._currentElement.find(".cancelBtn").on("click",function(a){return function(){a._closeCurrentPage()}}(this)),this.base._currentElement.find(".close").on("click",function(a){return function(){a._closeCurrentPage()}}(this)),this.base.log("Render start page")},a.prototype.success=function(){var a;a='<div class="step-success alert alert-info">\n  <button type="button" class="close"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>\n  <h4>'+this.base.options.texts.success.title+"</h4>\n  <p>"+this.base.options.texts.success.content+"</p>\n    <address>\n      "+this.base.addressData.streetName+" "+this.base.addressData.streetNumber+", "+this.base.addressData.postalCode+" "+this.base.addressData.city+", "+this.base.addressData.country+'\n    </address>\n  <button type="button" class="fillBtn btn btn-primary btn-xs">'+this.base.options.texts.success.fillBtn+"</button>\n</div>",this._closeCurrentPage(),this.base._currentElement.html(a),this.base._currentElement.find(".fillBtn").on("click",function(a){return function(){a.base.fillForm()}}(this)),this.base._currentElement.find(".close").on("click",function(a){return function(){a._closeCurrentPage()}}(this)),this.base.log("Render success page")},a.prototype.error=function(a,b,c){var d;null==c&&(c=!0),d='<div class="step-error alert alert-danger">\n  <button type="button" class="close"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>\n  <h4>'+a+"</h4>\n  <p>"+b+'</p>\n  <button type="button" class="tryBtn btn btn-primary btn-xs">'+this.base.options.texts.tryAgainBtn+"</button>\n</div>",this._closeCurrentPage(),this.base._currentElement.html(d),c===!1&&this.base._currentElement.find(".tryBtn").remove(),this.base._currentElement.find(".tryBtn").on("click",function(a){return function(){a.base.detect()}}(this)),this.base._currentElement.find(".close").on("click",function(a){return function(){a._closeCurrentPage()}}(this)),this.base.log("Render error page")},a.prototype.loading=function(){var a;a='<div class="step-loading alert alert-info">\n  <h4>'+this.base.options.texts.loading.title+"</h4>\n  <p>"+this.base.options.texts.loading.content+"</p>\n</div>",this._closeCurrentPage(),this.base._currentElement.html(a),this.base.log("Render loading page")},a}(),a=function(a){function c(a,f,g,h){return this.pluginName=h,this._getAddress=d(this._getAddress,this),f=$.extend({},e,f),c.__super__.constructor.call(this,a,f,g),""===f.formId?void this.log("There is no formId value","error"):0===$(this.options.formId).length?void this.log("Can't find form with id: "+f.formId,"error"):(this._currentElement=$(a),void(this.pages=new b(this)))}var e;return f(c,a),e={formId:"",addressId:"#street",cityId:"#city",postalId:"#zip",postalFirstId:"#zip-first",postalSecondId:"#zip-second",countryId:"#country",texts:{cancelBtn:"cancel",tryAgainBtn:"Try again",start:{title:"Location Detection",content:"We can detect your address to simplify form filling. Just press the button below.",detectBtn:"Detect location"},success:{title:"Is this your address?",content:'We think that this is your adress. If it is correct click "Fill form" button below.',fillBtn:"Fill form"},error:{title:"Ups...",geocoderFailed:"We cannot retrieve your location information right now :(",unsupportedBrowser:"Geolocation is not supported by this browser. Please try to use latest IE, Chrome, Firefox, Opera or Safari browser."},loading:{title:"Please wait...",content:"We are detecting your current location"}}},c.prototype.init=function(){this.addressData={streetNumber:"",streetName:"",city:"",country:"",postalCode:""},this.pages.start()},c.prototype.detect=function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(this._getAddress):(this.pages.error(this.options.texts.error.title,this.options.texts.error.unsupportedBrowser,!1),this.log("Geolocation is not supported by this browser.","error"))},c.prototype.fillForm=function(){var a;a=$(this.options.formId),a.find(this.options.addressId).val(this.addressData.streetName+" "+this.addressData.streetNumber),a.find(this.options.cityId).val(this.addressData.city),a.find(this.options.postalId).val(this.addressData.postalCode),a.find(this.options.postalFirstId).val(this.addressData.postalCode.split("-")[0]),a.find(this.options.postalSecondId).val(this.addressData.postalCode.split("-")[1]),a.find(this.options.countryId).val(this.addressData.country)},c.prototype._getAddress=function(a){var b,c,d,e;c=a.coords.latitude,e=a.coords.longitude,this.pages.loading(),b=new google.maps.Geocoder,d=new google.maps.LatLng(c,e),b.geocode({latLng:d},function(a){return function(b,c){c===google.maps.GeocoderStatus.OK&&(b[0]&&b[1]?(a.log(b[0].formatted_address),a._parseResult(b[0]),a._parseResult(b[1]),a.pages.success()):(a.pages.error(a.options.texts.error.title,a.options.texts.error.geocoderFailed),a.log("Geocoder failed due to: "+c,"error")))}}(this))},c.prototype._parseResult=function(a){var b,c,d,e,f,g;for(g=a.address_components,e=0,f=g.length;f>e;e++)switch(b=g[e],d=b.types[0],c=b.long_name,d){case"street_number":this.addressData.streetNumber=c;break;case"route":this.addressData.streetName=c;break;case"locality":this.addressData.city=c;break;case"country":this.addressData.country=c;break;case"postal_code":this.addressData.postalCode=c}},c}(c),function(b){var c;c="AddressDetectionWidget",b.fn[c]=function(d,e){var f,g;f=0,g=this.length,this.each(function(){var h,i;return f+=1,1===g&&(f="#"+b(this).attr("id")),h=c+"_"+f,i=new a(this,d,h,c,e),b.data(this,h)?void 0:(b.data(this,h,i),i.init())})}}(jQuery,window,document)}).call(this);